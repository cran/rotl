<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="David Winter" />

<meta name="date" content="2019-09-28" />

<title>Connecting data to Open Tree trees</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap;
}
pre {

border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Connecting data to Open Tree trees</h1>
<h4 class="author">David Winter</h4>
<h4 class="date">2019-09-28</h4>



<div id="combining-data-from-otol-and-other-sources." class="section level2">
<h2>Combining data from OToL and other sources.</h2>
<p>One of the major goals of <code>rotl</code> is to help users combine data from other sources with the phylogenetic trees in the Open Tree database. This examples document describes some of the ways in which a user might connect data to trees from Open Tree.</p>
</div>
<div id="get-open-tree-ids-to-match-your-data." class="section level2">
<h2>Get Open Tree IDs to match your data.</h2>
<p>Let’s say you have a dataset where each row represents a measurement taken from one species, and your goal is to put these measurements in some phylogenetic context. Here’s a small example: the best estimate of the mutation rate for a set of unicellular Eukaryotes along with some other property of those species which might explain the mutation rate:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">csv_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;protist_mutation_rates.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rotl&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csv_path, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">mu</a></code></pre></div>
<pre><code>##                     species       mu pop.size genome.size
## 1   Tetrahymena thermophila 7.61e-12 1.12e+08    1.04e+08
## 2    Paramecium tetraurelia 1.94e-11 1.24e+08    7.20e+07
## 3 Chlamydomonas reinhardtii 2.08e-10 1.00e+08    1.12e+08
## 4  Dictyostelium discoideum 2.90e-11 7.40e+06    3.40e+07
## 5  Saccharomyces cerevisiae 3.30e-10 1.00e+08    1.25e+08
## 6       Saccharomyces pombe 2.00e-10 1.00e+07    1.25e+08</code></pre>
<p>If we want to get a tree for these species we need to start by finding the unique ID for each of these species in the Open Tree database. We can use the Taxonomic Name Resolution Service (<code>tnrs</code>) functions to do this. Before we do that we should see if any of the taxonomic contexts, which can be used to narrow a search and avoid conflicts between different codes, apply to our group of species:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(rotl)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'lookup':
##   method         from
##   print.function base</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">tnrs_contexts</span>()</a></code></pre></div>
<pre><code>## Possible contexts:
##    Animals 
##       Birds, Tetrapods, Mammals, Amphibians, Vertebrates 
##       Arthropods, Molluscs, Nematodes, Platyhelminthes, Annelids 
##       Cnidarians, Arachnids, Insects 
##    Bacteria 
##       SAR group, Archaea, Excavata, Amoebozoa, Centrohelida 
##       Haptophyta, Apusozoa, Diatoms, Ciliates, Forams 
##    Fungi 
##       Basidiomycetes, Ascomycetes 
##    Land plants 
##       Hornworts, Mosses, Liverworts, Vascular plants, Club mosses 
##       Ferns, Seed plants, Flowering plants, Monocots, Eudicots 
##       Rosids, Asterids, Asterales, Asteraceae, Aster 
##       Symphyotrichum, Campanulaceae, Lobelia 
##    All life</code></pre>
<p>Hmm, none of those groups contain all of our species. In this case we can search using the <code>All life</code> context and the function <code>tnrs_match_names</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">taxon_search &lt;-<span class="st"> </span><span class="kw">tnrs_match_names</span>(<span class="dt">names =</span> mu<span class="op">$</span>species, <span class="dt">context_name =</span> <span class="st">&quot;All life&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(taxon_search)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">search_string</th>
<th align="left">unique_name</th>
<th align="left">approximate_match</th>
<th align="right">ott_id</th>
<th align="left">is_synonym</th>
<th align="left">flags</th>
<th align="right">number_matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tetrahymena thermophila</td>
<td align="left">Tetrahymena thermophila</td>
<td align="left">FALSE</td>
<td align="right">180195</td>
<td align="left">FALSE</td>
<td align="left">SIBLING_HIGHER</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">paramecium tetraurelia</td>
<td align="left">Paramecium tetraurelia</td>
<td align="left">FALSE</td>
<td align="right">568130</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">chlamydomonas reinhardtii</td>
<td align="left">Chlamydomonas reinhardtii</td>
<td align="left">FALSE</td>
<td align="right">33153</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">dictyostelium discoideum</td>
<td align="left">Dictyostelium discoideum</td>
<td align="left">FALSE</td>
<td align="right">160850</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">saccharomyces cerevisiae</td>
<td align="left">Saccharomyces cerevisiae</td>
<td align="left">FALSE</td>
<td align="right">356221</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">saccharomyces pombe</td>
<td align="left">Schizosaccharomyces pombe</td>
<td align="left">FALSE</td>
<td align="right">990004</td>
<td align="left">TRUE</td>
<td align="left"></td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Good, all of our species are known to Open Tree. Note, though, that one of the names is a synonym. <em>Saccharomyces pombe</em> is older name for what is now called <em>Schizosaccharomyces pombe</em>. As the name suggests, the Taxonomic Name Resolution Service is designed to deal with these problems (and similar ones like misspellings), but it is always a good idea to check the results of <code>tnrs_match_names</code> closely to ensure the results are what you expect.</p>
<p>In this case we have a good ID for each of our species so we can move on. Before we do that, let’s ensure we can match up our original data to the Open Tree names and IDs by adding them to our <code>data.frame</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">mu<span class="op">$</span>ott_name &lt;-<span class="st"> </span><span class="kw">unique_name</span>(taxon_search)</a>
<a class="sourceLine" id="cb8-2" title="2">mu<span class="op">$</span>ott_id &lt;-<span class="st"> </span>taxon_search<span class="op">$</span>ott_id</a></code></pre></div>
</div>
<div id="find-a-tree-with-your-taxa" class="section level2">
<h2>Find a tree with your taxa</h2>
<p>Now let’s find a tree. There are two possible options here: we can search for published studies that include our taxa or we can use the ‘synthetic tree’ from Open Tree. We can try both approaches.</p>
<div id="published-trees" class="section level3">
<h3>Published trees</h3>
<p>Before we can search for published studies or trees, we should check out the list of properties we can use to perform such searches:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">studies_properties</span>()</a></code></pre></div>
<pre><code>## $study_properties
##  [1] &quot;ot:studyPublicationReference&quot; &quot;ot:curatorName&quot;              
##  [3] &quot;ot:studyYear&quot;                 &quot;ot:focalClade&quot;               
##  [5] &quot;ot:focalCladeOTTTaxonName&quot;    &quot;ot:dataDeposit&quot;              
##  [7] &quot;ot:studyPublication&quot;          &quot;ot:tag&quot;                      
##  [9] &quot;ot:studyId&quot;                   &quot;ntrees&quot;                      
## [11] &quot;treebaseId&quot;                  
## 
## $tree_properties
##  [1] &quot;ot:treebaseOTUId&quot;           &quot;ot:nodeLabelMode&quot;          
##  [3] &quot;ot:originalLabel&quot;           &quot;oti_tree_id&quot;               
##  [5] &quot;ot:inferenceMethod&quot;         &quot;ot:tag&quot;                    
##  [7] &quot;ot:treebaseTreeId&quot;          &quot;ot:comment&quot;                
##  [9] &quot;ot:branchLengthDescription&quot; &quot;ot:treeModified&quot;           
## [11] &quot;ot:branchLengthTimeUnits&quot;   &quot;ot:branchLengthMode&quot;       
## [13] &quot;ot:treeLastEdited&quot;          &quot;ot:nodeLabelDescription&quot;   
## [15] &quot;ot:ottId&quot;                   &quot;ot:ottTaxonName&quot;           
## [17] &quot;ot:studyId&quot;                 &quot;ntips&quot;</code></pre>
<p>We have <code>ottIds</code> for our taxa, so let’s use those IDs to search for trees that contain them. Starting with our first species <em>Tetrahymena thermophila</em> we can use <code>studies_find_trees</code> to do this search.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">studies_find_trees</span>(<span class="dt">property =</span> <span class="st">&quot;ot:ottId&quot;</span>, <span class="dt">value =</span> <span class="kw">as.character</span>(<span class="kw">ott_id</span>(taxon_search)[<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>##    study_ids n_trees                                              tree_ids
## 1    ot_1044       1                                                 tree1
## 2    ot_1662       8                tree1, tree2, tree3, tree4, tree5, ...
## 3     ot_560       3                             Tr80090, Tr80091, Tr80092
## 4     ot_575       3                                   tree1, tree2, tree3
## 5     ot_650       1                                                 tree1
## 6     ot_651       1                                                 tree2
## 7     ot_705       1                                               Tr93612
## 8     ot_760       2                                           g0n0, tree1
## 9     ot_762       2                                          tree2, tree3
## 10     ot_89       2                                        Tr1003, Tr1004
## 11     ot_91       2                                      Tr46259, Tr46258
## 12     ot_96       2                                          tree1, tree2
## 13     ot_97       9                tree1, tree2, tree3, tree4, tree5, ...
## 14   pg_1272       1                                              tree2564
## 15   pg_1913       1                                              tree3903
## 16    pg_236       1                                              tree6285
## 17    pg_237       7       tree99, tree100, tree101, tree102, tree103, ...
## 18   pg_2412       4                tree5089, tree5090, tree5091, tree6403
## 19   pg_2435      24 tree5147, tree5148, tree5149, tree5150, tree5151, ...
## 20   pg_2533       6 tree5451, tree5452, tree5453, tree5454, tree5455, ...
## 21   pg_2618       2                                    tree6129, tree6130
## 22   pg_2702       3                          tree6272, tree6273, tree6274
## 23   pg_2762       3                          tree6384, tree6385, tree6386
## 24   pg_2924       1                                              tree6755
## 25    pg_301       2                                     tree205, tree5482
## 26    pg_310       3                             tree259, tree260, tree261
## 27    pg_315       1                                               tree266
## 28    pg_316       3                             tree267, tree268, tree269
## 29    pg_317       1                                               tree270
## 30    pg_424       1                                               tree532
## 31    pg_427       5          tree535, tree536, tree537, tree538, tree5574
## 32    pg_435       1                                              tree5995
## 33    pg_650       1                                              tree1147
## 34    pg_652       2                                    tree1152, tree5628
## 35    pg_655       1                                              tree1157
##                                                        candidate
## 1                                                               
## 2                                                               
## 3                                                        Tr80090
## 4                                                          tree3
## 5                                                          tree1
## 6                                                          tree2
## 7                                                        Tr93612
## 8                                                           g0n0
## 9                                                          tree3
## 10                                                              
## 11                                                              
## 12                                                         tree1
## 13 tree1, tree2, tree3, tree4, tree5, tree6, tree7, tree8, tree9
## 14                                                              
## 15                                                              
## 16                                                              
## 17                                                              
## 18                                                              
## 19                                                              
## 20                                                              
## 21                                                      tree6130
## 22                                                      tree6274
## 23                                                              
## 24                                                      tree6755
## 25                                                              
## 26                                                              
## 27                                                              
## 28                                                              
## 29                                                              
## 30                                                       tree532
## 31                                                              
## 32                                                      tree5995
## 33                                                      tree1147
## 34                                                              
## 35                                                              
##    study_year
## 1        2017
## 2        2017
## 3        2014
## 4        2007
## 5        2015
## 6        2010
## 7        2015
## 8        2013
## 9        2012
## 10       2007
## 11       2012
## 12       2014
## 13       2011
## 14       2009
## 15       2000
## 16       2000
## 17       2005
## 18       1999
## 19       2010
## 20       2010
## 21       2011
## 22       2014
## 23       2014
## 24       2014
## 25       2006
## 26       2011
## 27       2010
## 28       2012
## 29       2012
## 30       2010
## 31       2005
## 32       2008
## 33       2010
## 34       2012
## 35       2010
##                                                                                                                                                                                  title
## 1                         Eggshell palaeogenomics: Palaeognath evolutionary history revealed through ancient nuclear and mitochondrial DNA from Madagascan elephant bird (Aepyornis sp
## 2                                                                                                        'Ultraconserved elements resolve the phylogeny of potoos (Aves: Nyctibiidae)'
## 3                            'Phylogenetic Relationships and Morphological Character Evolution of Photosynthetic Euglenids (Excavata) Inferred from Taxon-rich Analyses of Five Genes'
## 4                                                                                                                                                                                     
## 5                                                                                                      The evolution of annelids reveals two adaptive routes to the interstitial realm
## 6                                                                                                      'Molecular phylogenetics and biogeography of Pollicipes (Crustacea: Cirripedia)
## 7                                            ' A DNA barcoding approach for identification of hidden diversity in Parmeliaceae (Ascomycota): P armelia sensu stricto as a case study '
## 8   'Phylogenetic relationships of the South American ground beetle subgenus &lt;i&gt;Chilioperyphus&lt;/i&gt; Jeannel (Coleoptera: Carabidae: Trechinae: Bembidiini: &lt;i&gt;Bembidion&lt;/i&gt; Latreille)'
## 9                                                                       'Phylogeny of Bembidion and related ground beetles (Coleoptera: Carabidae: Trechinae: Bembidiini: Bembidiina)'
## 10                                                                                                           Erysiphe abbreviata on cherry bark oak?morphology, phylogeny and taxonomy
## 11                                                                                        Taxonomic revisions of morphologically similar species from two euglenoid genera: Euglena (E
## 12 Phylogeny and taxonomy of sculpins, sandfishes, and snailfishes (Perciformes: Cottoidei) with comments on the phylogenetic significance of their early-life-history specializations
## 13                   'Multigene phylogenetic analyses including diverse radiolarian species support the “Retaria” hypothesis — The sister relationship of Radiolaria and Foraminifera'
## 14                                                                                                                                                                                    
## 15                                                                                                 Molecular phylogeny of Coriaria, with special emphasis on the disjunct distribution
## 16                                                                                                           Phylogeny of basal angiosperms: analyses of five genes from three genomes
## 17                                                                                    Phylogenetic analysis of basal angiosperms based on nine plastid mitochondrial and nuclear genes
## 18                                                                                                       Trochophore concepts: Evolution of larvae in polychaetes and other spiralians
## 19                                                                                                                                                                                    
## 20                                                     Species delimitation using a combined coalescent and information theoretic approach: An example from North American Myotis bats
## 21                                                      'Ultrastructure and LSU rDNA-based Phylogeny of Peridinium lomnickii and Description of Chimonodinium gen. nov. (Dinophyceae)'
## 22                                                                            Resolving deep lineage divergences in core corvoid passerine birds supports a proto-Papuan island origin
## 23                                                         Genome sequencing and comparative analysis of three Chlamydia pecorum strains associated with different pathogenic outcomes
## 24                                                                                                A comprehensive multilocus assessment of sparrow (Aves: Passerellidae) relationships
## 25                                                                                                                                                  Perspectives in the new Russulales
## 26                                                                                                                                                        Subulatomonas tetraspora nov
## 27                                                                                                      Molecular phylogenetics and taxonomy of the genus Thysanocarpus (Brassicaceae)
## 28                                                                                                                                                                                    
## 29                                                                                                                                                                                    
## 30                                                             Combining historical biogeography with niche modeling in the Caprifolium clade of Lonicera (Caprifoliaceae, Dipsacales)
## 31                                                                                                                                                                                    
## 32                                                                                                   Strong mitochondrial DNA support for a Cretaceous origin of modern avian lineages
## 33                                                                                                        Biogeography of Cedrela (Meliaceae, Sapindales) in Central and South America
## 34                                                                                                                                                           Annulatascus aquatorba sp
## 35                                                Tracing the Temporal and Spatial Origins of Island Endemics in the Mediterranean Region: A Case Study from the Citrus Family (Ruta L
##                                               study_doi n_matched_trees
## 1         http://dx.doi.org/10.1016/j.ympev.2017.01.005               1
## 2                   http://dx.doi.org/10.1111/jav.01313               1
## 3                   http://dx.doi.org/10.1111/jeu.12192               1
## 4    http://dx.doi.org/10.1111/j.1096-3642.2007.00306.x               1
## 5           http://dx.doi.org/10.1016/j.cub.2015.06.007               1
## 6         http://dx.doi.org/10.1016/j.jembe.2010.04.024               1
## 7                   http://dx.doi.org/10.1111/boj.12358               1
## 8           http://dx.doi.org/10.11646/zootaxa.3636.4.3               1
## 9         http://dx.doi.org/10.1016/j.ympev.2012.01.015               1
## 10         http://dx.doi.org/10.3852/mycologia.99.5.655               1
## 11   http://dx.doi.org/10.1111/j.1529-8817.2012.01140.x               2
## 12        http://dx.doi.org/10.1016/j.ympev.2014.06.028               2
## 13     http://dx.doi.org/10.1016/j.marmicro.2011.06.007               5
## 14   http://dx.doi.org/10.1111/j.1558-5646.2008.00567.x               1
## 15             http://dx.doi.org/10.1006/mpev.1999.0672               1
## 16                     http://dx.doi.org/10.1086/317584               1
## 17                     http://dx.doi.org/10.1086/431800               1
## 18 http://dx.doi.org/10.1111/j.1095-8312.1999.tb01920.x               2
## 19           http://dx.doi.org/10.1186/1471-2148-10-234               1
## 20              http://dx.doi.org/10.1093/sysbio/syq024               2
## 21       http://dx.doi.org/10.1016/j.protis.2011.03.003               1
## 22        http://dx.doi.org/10.1016/j.ympev.2013.09.027               1
## 23            http://dx.doi.org/10.1186/1471-2164-15-23               1
## 24        http://dx.doi.org/10.1016/j.ympev.2014.04.025               1
## 25         http://dx.doi.org/10.3852/mycologia.98.6.960               2
## 26       http://dx.doi.org/10.1016/j.protis.2011.05.002               1
## 27         http://dx.doi.org/10.1600/036364410792495926               1
## 28                                                                    2
## 29                                                                    1
## 30              http://dx.doi.org/10.1093/sysbio/syq011               1
## 31        http://dx.doi.org/10.3852/mycologia.97.5.1140               3
## 32              http://dx.doi.org/10.1186/1741-7007-6-6               1
## 33                http://dx.doi.org/10.3732/ajb.0900229               1
## 34                     http://dx.doi.org/10.3852/11-238               2
## 35              http://dx.doi.org/10.1093/sysbio/syq046               1
##                  match_tree_ids
## 1                          NULL
## 2                          NULL
## 3                          NULL
## 4                          NULL
## 5                          NULL
## 6                          NULL
## 7                          NULL
## 8                          NULL
## 9                          NULL
## 10                         NULL
## 11                   NULL, NULL
## 12                   NULL, NULL
## 13 NULL, NULL, NULL, NULL, NULL
## 14                         NULL
## 15                         NULL
## 16                         NULL
## 17                         NULL
## 18                   NULL, NULL
## 19                         NULL
## 20                   NULL, NULL
## 21                         NULL
## 22                         NULL
## 23                         NULL
## 24                         NULL
## 25                   NULL, NULL
## 26                         NULL
## 27                         NULL
## 28                   NULL, NULL
## 29                         NULL
## 30                         NULL
## 31             NULL, NULL, NULL
## 32                         NULL
## 33                         NULL
## 34                   NULL, NULL
## 35                         NULL</code></pre>
<p>Well… that’s not very promising. We can repeat that process for all of the IDs to see if the other species are better represented.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">hits &lt;-<span class="st"> </span><span class="kw">lapply</span>(mu<span class="op">$</span>ott_id, studies_find_trees, <span class="dt">property =</span> <span class="st">&quot;ot:ottId&quot;</span>, <span class="dt">detailed =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">sapply</span>(hits, <span class="cf">function</span>(x) <span class="kw">sum</span>(x[[<span class="st">&quot;n_matched_trees&quot;</span>]]))</a></code></pre></div>
<pre><code>## [1]  48  51 128  70  17  87</code></pre>
<p>OK, most of our species are not in any of the published trees available. You can help fix this sort of problem by <a href="https://tree.opentreeoflife.org/curator">making sure you submit your published trees to Open Tree</a>.</p>
</div>
<div id="a-part-of-the-synthesis-tree" class="section level3">
<h3>A part of the synthesis tree</h3>
<p>Thankfully, we can still use the complete Tree of Life made from the combined results of all of the published trees and taxonomies that go into Open Tree. The function <code>tol_induced_subtree</code> will fetch a tree relating a set of IDs.</p>
<p>Using the default arguments you can get a tree object into your R session:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">ott_in_tree &lt;-<span class="st"> </span><span class="kw">ott_id</span>(taxon_search)[<span class="kw">is_in_tree</span>(<span class="kw">ott_id</span>(taxon_search))]</a>
<a class="sourceLine" id="cb15-2" title="2">tr &lt;-<span class="st"> </span><span class="kw">tol_induced_subtree</span>(<span class="dt">ott_ids =</span> ott_in_tree)</a></code></pre></div>
<pre><code>## Warning in collapse_singles(tr, show_progress): Dropping singleton
## nodes with labels: mrcaott2ott276, mrcaott2ott142555, mrcaott2ott3043,
## mrcaott2ott7623, Chloroplastida ott361838, Chlorophyta ott979501,
## mrcaott185ott23323, mrcaott185ott599, mrcaott1427ott25671,
## mrcaott1427ott1544, mrcaott1544ott15345, mrcaott1544ott1795,
## mrcaott9389ott365252, mrcaott9389ott23557, mrcaott23557ott527099,
## mrcaott149ott902, SAR ott5246039, Alveolata ott266751, Ciliophora (phylum
## in subkingdom SAR) ott302424, Intramacronucleata ott340382, Conthreep
## ott5248773, Peniculia ott5257364, Paramecium (genus in subkingdom SAR)
## ott568126, Hymenostomatia ott5257367, Tetrahymena ott47284, Amoebozoa
## ott1064655, mrcaott3973ott5765, mrcaott3973ott26103, mrcaott26103ott273110,
## mrcaott26103ott229626, Dictyostelia ott835575, Dictyostelium ott999665,
## Opisthokonta ott332573, Nucletmycea ott5246132, Fungi ott352914,
## mrcaott48ott3465, mrcaott48ott67172, mrcaott48ott1423, mrcaott48ott4814,
## h2007-2 ott5576447, h2007-1 ott5584405, Dikarya ott656316,
## mrcaott48ott1053, Saccharomycetales ott5976840, Saccharomycetaceae
## ott989994, Saccharomyces ott908546, Taphrinomycotina ott656312,
## Schizosaccharomycetes ott921286, Schizosaccharomycetidae ott5670481,
## Schizosaccharomycetales ott508517, Schizosaccharomycetaceae ott990009,
## Schizosaccharomyces ott990008</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">plot</span>(tr)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="connect-your-data-to-the-tips-of-your-tree" class="section level3">
<h3>Connect your data to the tips of your tree</h3>
<p>Now we have a tree for of our species, how can we use the tree and the data together?</p>
<p>The package <code>phylobase</code> provide an object class called <code>phylo4d</code>, which is designed to represent a phylogeny and data associated with its tips. In oder to get our tree and data into one of these objects we have to make sure the labels in the tree and in our data match exactly. That’s not quite the case at the moment (tree labels have underscores and IDs appended):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">mu<span class="op">$</span>ott_name[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## $`Tetrahymena thermophila`
## [1] &quot;Tetrahymena thermophila&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">tr<span class="op">$</span>tip.label[<span class="dv">4</span>]</a></code></pre></div>
<pre><code>## [1] &quot;Dictyostelium_discoideum_ott160850&quot;</code></pre>
<p><code>rotl</code> provides a convienence function <code>strip_ott_ids</code> to deal with these.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">tr<span class="op">$</span>tip.label &lt;-<span class="st"> </span><span class="kw">strip_ott_ids</span>(tr<span class="op">$</span>tip.label, <span class="dt">remove_underscores =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-2" title="2">tr<span class="op">$</span>tip.label <span class="op">%in%</span><span class="st"> </span>mu<span class="op">$</span>ott_name</a></code></pre></div>
<pre><code>## [1] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<p>Ok, now the tips are together we can make a new dataset. The <code>phylo4d()</code> functions matches tip labels to the row names of a <code>data.frame</code>, so let’s make a new dataset that contains just the relevant data and has row names to match the tree</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">library</span>(phylobase)</a>
<a class="sourceLine" id="cb24-2" title="2">mu_numeric &lt;-<span class="st"> </span>mu[, <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;pop.size&quot;</span>, <span class="st">&quot;genome.size&quot;</span>)]</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="kw">rownames</span>(mu_numeric) &lt;-<span class="st"> </span>mu<span class="op">$</span>ott_name</a>
<a class="sourceLine" id="cb24-4" title="4">tree_data &lt;-<span class="st"> </span><span class="kw">phylo4d</span>(tr, mu_numeric)</a></code></pre></div>
<p>And now we can plot the data and the tree together</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">plot</span>(tree_data)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="find-external-data-associated-with-studies-trees-and-taxa-from-open-tree" class="section level2">
<h2>Find external data associated with studies, trees and taxa from Open Tree</h2>
<p>In the above example we looked for a tree that related species in another dataset. Now we will go the other way, and try to find data associated with Open Tree records in other databases.</p>
<div id="get-external-data-from-a-study" class="section level3">
<h3>Get external data from a study</h3>
<p>Let’s imagine you were interested in extending or reproducing the results of a published study. If that study is included in Open Tree you can find it via <code>studies_find_studies</code> or <code>studies_find_trees</code> and retrieve the published trees with <code>get_study</code>. <code>rotl</code> will also help you find external. The function <code>study_external_IDs</code> retrieves the DOI for a given study, and uses that to gather some more data:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">extra_data &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">study_external_IDs</span>(<span class="st">&quot;pg_1980&quot;</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw">inherits</span>(extra_data, <span class="st">&quot;try-error&quot;</span>)) {</a>
<a class="sourceLine" id="cb26-3" title="3">  extra_data</a>
<a class="sourceLine" id="cb26-4" title="4">}</a></code></pre></div>
<pre><code>## External data identifiers for study 
##  $doi:  10.1016/j.ympev.2006.04.016 
##  $pubmed_id:  16762568 
##  $nucleotide_ids: vector of 58 IDs
##  $external_data_url http://purl.org/phylo/treebase/phylows/study/TB2:S1575</code></pre>
<p>Here the returned object contains an <code>external_data_url</code> (in this case a link to the study in Treebase), a pubmed ID for the paper and a vector IDs for the NCBI’s nuleotide database. The packages <code>treebase</code> and <code>rentrez</code> provide functions to make use of these IDs within R.</p>
<p>As an example, let’s use <code>rentrez</code> to download the first two DNA seqences and print them.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">library</span>(rentrez)</a>
<a class="sourceLine" id="cb28-2" title="2">seqs &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">entrez_fetch</span>(<span class="dt">db =</span> <span class="st">&quot;nucleotide&quot;</span>, <span class="dt">id =</span> extra_data<span class="op">$</span>nucleotide_ids[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">rettype =</span> <span class="st">&quot;fasta&quot;</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="cf">if</span> (<span class="kw">inherits</span>(seqs, <span class="st">&quot;try-error&quot;</span>)) {</a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="kw">cat</span>(<span class="st">&quot;NCBI temporarily down.&quot;</span>)</a>
<a class="sourceLine" id="cb28-6" title="6">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb28-7" title="7">  <span class="kw">cat</span>(seqs)</a>
<a class="sourceLine" id="cb28-8" title="8">}</a></code></pre></div>
<pre><code>## &gt;AM181011.1 Plectroninia neocaledoniense partial 28S rRNA gene, specimen voucher G316300 (Queensland Museum)
## GCTAGCAAGCGCGTCGGTGGTTCAGCCGGCTGGTCTCGTCGAGTTGTCGGTGTGCGGATCCGAACGGACC
## GCGGCCGATGGCGTCGGCGGGCAAGCTGTGGTGCACTCTGTCGGCGTGCGCGTCAGCGTCGGTTTCGGCC
## GGACGACGAGGCGCTCGGGGAAGGTAGCTGGACCGGTCTTCGGTGCAGTGTTATAGCCCTGGGCCGCTGG
## GTTCGGCGTTTGGGACCGAGGAGAGAGATGATCGCTGCAGCGCCTGTCTCCCTCTCGAGGGGGGCTAGCC
## AGCCGCTGTTTGGGTGGCGTCACTGGCGGAGGACTGCACGCAGTGCTTCGCCGGTGGTCGTGTCCAGGCG
## GGCGGTGTGGGTATAGAGGCGCTTAGGACGCTGGCGTCCAAATGGCCGTGCGCGACCCGTCTTGAAACAC
## GGACCAAGGAGTCTAGCATGTGCGCGAGTCTTAGGGTGTGGAAGCCCTCGGGCGCAATGAAAGTGAAGGG
## CCGTCGTCTCTCGGGGCTGCGGTGTGAGGTGAGAGCCGTCGCCGTCGGGTGGCGGTGCATCATCGGCCGG
## TCCATCCTGCTCTCAGGAGGATCTGCGCAAGAGCGTGTTTGCTGGGACCCGAAAGATGGTGAACTATGCC
## TGAATAGGGTGAAGCCAGAGGAAACTCTGGTGGAGGCTCGTAGCGGTTCTGACGTGCAAATCGATCGTCA
## AATTTGGGTATAGGGGCGAAAGACTAATCGAACCATCTAGTAGCTGGTTCCCTCCGAAGTTTCCCTCAGG
## ATAGCTGGAACTCGTCTTGACACAGTTTTATCAGGTAAAGCGAATGATTAGAGGTCTTGGGGGTGAAACA
## CCCTCAACCTATTCTCAAACTTTAAATAGGTAAGAAGCGCGACTTGCTCAATTGAAGTGGCGCGCAGTGA
## ATGTGAGTTCCAAGTGGGCCATTTTTGGTAAGCAGAACTGGCGATGCGGGATGAACCGAACGCTCGGTTA
## AGGTGCCCAAGTCGACGCTCATCAGACCCCAGAAAAGGTGTTGGTCGATATAGACAGCAGGACGGTGGCC
## ATGGAAGTCGGAATCCGCTAAGGAGTGTGTAACAACTCACCTGCCGAATCAACTAGCCCTGAAAATGGAT
## GGCGCTCAAGCGTCGCACCTATACCGAGCCGTCGTGGTAAATGCCAGGCCACGACGAGTAGGAGGGCGCG
## GTGGTCGTGACGCAGCCCTTGGCGCGAGCCTGGGCGAAACGGCCTCCGGTGCAGATCTTGGTGGTAGTAG
## CAAATATTCAAATGAGAGCTTTGAAGACCGAAGTGGAGAAAGGTTCCATGTGAACAGCAGTTGGACATGG
## GTTAGTCGATCCTAAGAGATAGGGAAGTTCCGTGTGAAAGTGCGCAATGCGCTTCTGTGCTGCGCGCCTC
## CTATCGAAAGGGAATCGGGTTAATATTCCCGAACCGGAAGGCGGATATCTCTGGCTCTCGGGTCAGGAGC
## GGCAACGCAAGCGTACTGCGAGACGTCGGCGGGGGCTCCGGGAAGAGTTGTCTTTTCTTTTTAACGCAGT
## CGCCATCCCTGGAATCGGTTTGCCCGGAGATAGGGTTGGCTGGCTCGGTAAAGCAGCACACTTCATGTGC
## TGTCCGGTGCGCTCTCGACGGCCCTTGAAAATCGCAGGTGTGCATCGATTCTCGCATCCGGTCGTACTCA
## TAACCGCATCAGGTCTCCAAGGT
## 
## &gt;AM181010.1 Eilhardia schulzei partial 28S rRNA gene, specimen voucher G316071 (Queensland Museum)
## GCTAGTAATGTACGTTGGTGGTTCAGCCGGCTAGTCTTGTCGAGTCGTCGTGTGGTGGATCCGACTGGAC
## CGTCCGCGGTGGTGTCGGCGGGCGAGCTGTGGTGCACTCTACGGACGTGCGCGTCAGCGTCGGTTCTCGA
## TGGGCGATAAGGTGCGTGGGGGAAGGTGGCTCGGTCCTTGGGAACTGAGTGTTACAGACCCTGGTGCTGG
## GCTCGTCGTGGGACCGAGGAGAGAGAGAGATGATCGCTGCGGCACCTGCCCCGTTGTCATTTTTCGGGGC
## TAGCCAGCCGTTTGTCAGGTGTGCGTCGGACGTTGAGGACTGCACGCAGTGCTGGACGTGGAGGCGTGAT
## CTGATGGCGGTGTGGGCATTAGAGGTGCCTAGGACGCTGGCGTCCAAATGGCCGTGCGCGACCCGTCTTG
## AAACACGGACCAAGGAGTCTAACATGTGCGCGAGTCTTAGGGTGTGCAAGCCCTCGGGCGCAATGAAAGT
## GAAGGCTCGGCGGCGCTAGTCGAGCTGAGGTGAGAGCCGTGGCCGTTGCATGTGGCGGCGGCGGCGCATC
## ATCGGCCGGTCCATCCTGCTCTCAGGGGGATCCGAGCAAGAGCGTATTTGTTGGGACCCGAAAGATGGTG
## AACTATGCCTGAATAGGGTGAAGCCAGAGGAAACTCTGGTGGAGGCTCGTAGCGATTCTGACGTGCAAAT
## CGATCGTCAAATTTGGGTATAGGGGCGAAAGACTAATCGAACCATCTAGTAGCTGGTTCCCTCCGAAGTT
## TCCCTCAGGATAGCTGGAGCTCTTGGACACAGTTTTATCAGGTAAAGCGAATGATCAGAGGTCTTGGGGG
## TGAAACACCCTCAACCTATTCTCAAACTTTAAATCGGTAAGAAGCGCGACTTGCTGAATTGAAGCCGCGC
## GCAAGCAATGTGAGTTCCAAGTGGGCCATTTTTGGTAAGCAGAACTGGCGATGCGGGATGAACCGAACGC
## TGGGTTAAGGTGCCAAAGTCGACGCTCATCAGACCCCAGAAAAGGTGTTGGTTGATATAGACAGCAGGAC
## GATGGCCATGGAAGTCGGAATCCGCTAAGGAGTGTGTAACAACTCACCTGCCGAATCAACTAGCCCTGAA
## AATGGATGGCGCTCAAGCGTCGCACCTATACCGGGCCGTCGTCGCAAATGCCAGGCGACGACGAGTAGGA
## GGGCGCAGTGGTCGTCATGCAGCCCTTGGCGTGAGCCTGGGTCAAACGGCCTCTGGTGCAGATCTTGGTG
## GTAGTAGCAAATATTCAAATGAGAGCTTTGAAGACCGAAGTGGAGAAAGGTTCCATGTGAACAGCAGTTG
## GACATGGGTTAGTCGATCCTAAGTGATAGGGGAGCTCCGTATGAAAGTGCGCAATCGGCCCTGCTTGTGT
## CGCCTTGCGCCACCTATCGAAAGGGAATCGGGTTAATATTCCCGAACCGGAAGGCGGATTTTCTCTGGCT
## CTCGGGTCAGGAGCGGCAACGCTAGCGAACCGCGAGACGTCGGCGGGGGCTCCGGGAAGAGTTGTCTTTT
## CTTTTTAACGCAGTCGCCATCCCTGGAATCGGTTTGCCCGGAGATAGGGTTGGCTGGCTCGGTAAAGCAG
## CACACTTCATGTGCTGTCCGGTGCGCTCTCGACGGCCCTTGAAAATCGCGGCGAGTGTAGTCTGATTTTC
## GCATCCGTTCGTACTCATAACCGCATCAGGTCTCCAAGGT</code></pre>
<p>You could further process these sequences in R with the function <code>read.dna</code> from <code>ape</code> or save them to disk by specifying a file name with <code>cat</code>.</p>
</div>
<div id="find-a-ott-taxon-in-another-taxonomic-database" class="section level3">
<h3>Find a OTT taxon in another taxonomic database</h3>
<p>It is also possible map an Open Tree taxon to a record in another taxonomic database. For instance, if we wanted to search for data about one of the tips of the sub-tree we fetched in the example above we could do so using <code>taxon_external_IDs</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">Tt_ids &lt;-<span class="st"> </span><span class="kw">taxon_external_IDs</span>(mu<span class="op">$</span>ott_id[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb30-2" title="2">Tt_ids</a></code></pre></div>
<pre><code>##   source       id
## 1  silva AY102613
## 2   ncbi     5888
## 3   gbif  7415807</code></pre>
<p>A user could then use <code>rgbif</code> to find locality records using the gbif ID or <code>rentrez</code> to get genetic or bibliometric data about from the NCBI’s databases.</p>
</div>
</div>
<div id="what-next" class="section level2">
<h2>What next</h2>
<p>The demonstration gets you to the point of visualizing your data in a phylogenetic context. But there’s a lot more you do with this sort of data in R. For instance, you could use packages like <code>ape</code>, <code>caper</code>, <code>phytools</code> and <code>mcmcGLMM</code> to perform phylogenetic comparative analyses of your data. You could gather more data on your species using packages that connect to trait databases like <code>rfishbase</code>, <code>AntWeb</code> or <code>rnpn</code> which provides data from the US National Phenology Network. You could also use <code>rentrez</code> to find genetic data for each of your species, and use that data to generate branch lengths for the phylogeny.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
